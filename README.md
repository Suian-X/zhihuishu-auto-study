# 智慧树自动刷课脚本 🐢💤

> “人生苦短，视频漫长”，于是有了这个小脚本。  
> 注意：这个脚本并不完美，主要目的是减少消费的无意义时间，推荐理解原理后自行改进。

---

技术栈:
  - Python 3.x
  - GUI / ROI 选择: PyQt5
  - 屏幕截图与图像处理: Pillow, numpy
  - 自动化鼠标操作: pyautogui
  - 视频静止检测: 通过计算截图的均方误差 (MSE)
  - 人类化操作: 鼠标曲线移动、偶发微抖、点击随机偏移和持续按压

---

浅谈几句:
  这个脚本的核心思路是尽量模仿人类行为，自动完成智慧树课程的视频播放和弹窗处理。运行时会定期抓取视频区域截图，计算两帧之间的差异，当检测到视频连续静止超过设定次数时，开始判定是弹出题目还是播放结束，然后答题或者点击下一节。  

  脚本还会监控答题区和关闭区，如果检测到弹窗变化，就会模拟点击答题区域并关闭弹窗，保证播放不被中断。同时，它会偶尔微微移动鼠标，点击位置也带随机偏移，以规避智慧树网站中存在的反自动化检测。  

  在使用前，你可以交互式选择视频区、下一课区、答题区和关闭区的 ROI，选定后会保存到 `rois.json` 文件，不小心退出后可直接复用，无需重复选择。  

  最后提一嘴，愚蠢的智慧树为了防止被自动化抓取，居然在页面中注入动态的 `debugger;` 语句和 VMxxx 混淆代码，否则油猴脚本会是更合适的选择。

---

使用方式:
  1. 安装依赖:
      pip install -r requirements.txt
  2. 打开智慧树课程页面，确保布局稳定
  3. 运行脚本:
      python main.py
  4. 按提示交互选择 ROI（视频区 / 下一课区 / 答题区 / 关闭区）
  5. 设置参数或直接使用默认参数开始自动化
  6. Ctrl+C 可随时中断脚本

---

建议改进方向:
  - 弹窗检测可以加入更智能的图像识别
  - 视频播放检测可以结合音频或网页 JS 播放状态
  - 增加日志或截图记录，方便调试
